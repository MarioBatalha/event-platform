import{g as e,w as n}from"./p-aa8acb66.js";import{d as t,j as i,l as o,D as a}from"./p-b018976f.js";import{P as r}from"./p-121aab6e.js";import{a as c}from"./p-8acb8eb5.js";const s=n=>(i,o)=>{const a=t(n,HTMLElement)?n:e(n),r=new CustomEvent("vmProviderChange",{bubbles:!0,composed:!0,detail:{by:a,prop:i,value:o}});a.dispatchEvent(r)},u=new Set(["ready","playing","playbackReady","playbackStarted","playbackEnded","seeking","buffered","buffering","duration","viewType","mediaTitle","mediaType","currentSrc","currentPoster","playbackRates","playbackQualities","textTracks","currentTextTrack","isTextTrackVisible","audioTracks","currentAudioTrack","isPiPActive","isFullscreenActive"]);var d=function(e,n,t,i){return new(t||(t=Promise))((function(o,a){function r(e){try{s(i.next(e))}catch(e){a(e)}}function c(e){try{s(i.throw(e))}catch(e){a(e)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}s((i=i.apply(e,n||[])).next())}))};const v=Symbol("vmProviderCache");function l(e,n){return new CustomEvent(e,{bubbles:!0,composed:!0,detail:n})}function b(t){const s=e(t),b=new a,f=new Map;function m(o){o.stopImmediatePropagation(),Object.keys(t).forEach((e=>{f.set(e,t[e])}));const a=o.detail,c=e(o.detail);if(t.provider===c)return;const u=null==c?void 0:c.nodeName.toLowerCase().replace("vm-","");n((()=>d(this,void 0,void 0,(function*(){t.provider=c,t.currentProvider=Object.values(r).find((e=>u===e)),i(a,void 0,(()=>function(){n((()=>d(this,void 0,void 0,(function*(){var e;t.ready=!1,t.provider=void 0,f.clear(),null===(e=t.onProviderDisconnect)||void 0===e||e.call(t),s.dispatchEvent(l("vmMediaProviderDisconnect"))}))))}()))}))))}function p(e){var i;e.stopImmediatePropagation();const{by:o,prop:a,value:r}=e.detail;(e=>c(e)||u.has(e))(a)?n((()=>{f.set(a,r),t[a]=r})):null===(i=t.logger)||void 0===i||i.warn(`${o.nodeName} tried to change \`${a}\` but it is readonly.`)}t[v]=f,i(t,(()=>{b.add(o(s,"vmMediaProviderConnect",m)),b.add(o(s,"vmProviderChange",p))}),(()=>{b.empty(),f.clear()}))}function f(n){const t=l("vmMediaProviderConnect",n);i(n,(()=>{e(n).dispatchEvent(t)}))}export{v as P,b as a,s as c,f as w}